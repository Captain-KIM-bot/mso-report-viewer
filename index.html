<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>MSO ë¦¬í¬íŠ¸</title>
  <link rel="stylesheet" href="style.css">
  <style>
    #login {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: #ffffff;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 1000;
    }
    #login input, #login button {
      padding: 10px;
      font-size: 16px;
      margin-top: 10px;
    }
    #report-buttons button, #extra-buttons button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 15px;
      background: #4B8BBE;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    #report-buttons button:hover, #extra-buttons button:hover {
      background: #306998;
    }
  </style>
</head>
<body style="display:none">

  <!-- ë¹„ë°€ë²ˆí˜¸ ë¡œê·¸ì¸ -->
  <div id="login">
    <h2>ì ‘ì†ì„ ìœ„í•´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”</h2>
    <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥">
    <button onclick="checkPassword()">í™•ì¸</button>
    <p id="login-error" style="color:red; display:none;">âŒ ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤</p>
  </div>

  <!-- ë³¸ë¬¸ ì˜ì—­ -->
  <div id="main">
    <h1>MSO ë¦¬í¬íŠ¸ ë·°ì–´</h1>
    <div class="selector">
      <select id="hospital" onchange="onHospitalChange()"><option>ë³‘ì› ì„ íƒ</option></select>
      <select id="branch" onchange="onBranchChange()"><option>ì§€ì  ì„ íƒ</option></select>
    </div>

    <h2>ğŸ“„ ë³´ê³ ì„œ</h2>
    <div id="report-buttons" class="buttons"></div>

    <h2>ğŸ“ ì¶”ê°€ìë£Œ</h2>
    <div id="extra-buttons" class="buttons"></div>

    <h2>ğŸ“„ ì£¼ì°¨ë³„ ë³´ê³ ì„œ</h2>
    <div id="extra-buttons" class="buttons"></div>
  </div>

  <script src="data.js"></script>
  <script>
    const PASSWORD = "mso1234"; // ë¹„ë°€ë²ˆí˜¸ ì„¤ì •

    function checkPassword() {
      const input = document.getElementById("password").value;
      const error = document.getElementById("login-error");
      if (input === PASSWORD) {
        document.getElementById("login").style.display = "none";
        document.body.style.display = "block";
        populateHospitals();
      } else {
        error.style.display = "block";
      }
    }

    const hSelect = document.getElementById("hospital"),
          bSelect = document.getElementById("branch"),
          reportArea = document.getElementById("report-buttons"),
          extraArea = document.getElementById("extra-buttons");

    function populateHospitals() {
      Object.keys(data).forEach(h => {
        const o = new Option(data[h].name, h);
        hSelect.add(o);
      });
    }

    function onHospitalChange() {
      bSelect.innerHTML = "<option>ì§€ì  ì„ íƒ</option>";
      reportArea.innerHTML = "";
      extraArea.innerHTML = "";
      const branchData = data[hSelect.value]?.branches || {};
      Object.keys(branchData).forEach(b => {
        bSelect.add(new Option(branchData[b].name, b));
      });
    }

    function onBranchChange() {
      reportArea.innerHTML = "";
      extraArea.innerHTML = "";
      const branch = data[hSelect.value]?.branches?.[bSelect.value];
      if (!branch) return;

      // ë³´ê³ ì„œ ë²„íŠ¼ ìƒì„±
      Object.entries(branch.reports || {}).forEach(([mo, url]) => {
        const btn = document.createElement("button");
        btn.textContent = mo;
        btn.onclick = () => window.open(url, "_blank");
        reportArea.appendChild(btn);
      });

      // ì¶”ê°€ìë£Œ ë²„íŠ¼ ìƒì„±
      Object.entries(branch.extras || {}).forEach(([mo, url]) => {
        const btn = document.createElement("button");
        btn.textContent = mo;
        btn.onclick = () => window.open(url, "_blank");
        extraArea.appendChild(btn);
              
      // ì£¼ì°¨ë³„ë³´ê³ ì„œ ë²„íŠ¼ ìƒì„±
      Object.entries(branch.extras || {}).forEach(([mo, url]) => {
        const btn = document.createElement("button");
        btn.textContent = mo;
        btn.onclick = () => window.open(url, "_blank");
        extraArea.appendChild(btn);
      });
    }
  </script>
</body>
</html>
